<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>La Vie Au Moyen √Çge - Jeux Interactifs</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@700&family=EB+Garamond:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --brun-sombre: #3e2723;
            --brun-moyen: #5d4037;
            --or: #d4af37;
            --creme: #fdf5e6;
            --reussite: #2e7d32;
            --erreur: #c62828;
        }

        * { box-sizing: border-box; transition: all 0.2s ease; -webkit-tap-highlight-color: transparent; }

        body {
            font-family: 'EB Garamond', serif;
            background: #2a1b15;
            color: var(--brun-sombre);
            margin: 0;
            padding: 10px;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
        }

        .parchemin {
            background-color: var(--creme);
            max-width: 800px;
            width: 100%;
            border: 8px solid var(--brun-moyen);
            box-shadow: 0 10px 40px rgba(0,0,0,0.6);
            padding: 20px;
            position: relative;
            text-align: center;
            border-radius: 4px;
            margin-top: 10px;
        }

        @media (min-width: 600px) {
            .parchemin { padding: 40px; border-width: 14px; }
        }

        .parchemin::before {
            content: '';
            position: absolute;
            top: 5px; left: 5px; right: 5px; bottom: 5px;
            border: 2px solid var(--or);
            pointer-events: none;
        }

        h1 {
            font-family: 'Cinzel', serif;
            font-size: 26px;
            margin: 0 0 10px 0;
            color: var(--brun-sombre);
            text-transform: uppercase;
        }

        @media (min-width: 600px) { h1 { font-size: 42px; } }

        .equipe {
            font-size: 15px;
            color: var(--brun-moyen);
            margin-bottom: 25px;
            font-style: italic;
            border-bottom: 1px solid var(--or);
            display: inline-block;
            padding: 0 15px 5px 15px;
        }

        .btn-medieval {
            background: var(--brun-moyen);
            color: var(--or);
            border: 2px solid var(--or);
            padding: 15px 25px;
            font-family: 'Cinzel', serif;
            font-size: 16px;
            cursor: pointer;
            margin: 8px;
            width: 100%;
            max-width: 350px;
            border-radius: 4px;
        }

        .btn-medieval:hover { background: var(--brun-sombre); transform: translateY(-2px); }

        .section-jeu { display: none; }

        /* QUIZ */
        .question-box { font-size: 22px; font-weight: bold; margin-bottom: 20px; padding: 20px; background: rgba(212, 175, 55, 0.1); border-radius: 8px; border-left: 5px solid var(--or); }
        .options-grid { display: grid; grid-template-columns: 1fr; gap: 12px; }
        @media (min-width: 600px) { .options-grid { grid-template-columns: 1fr 1fr; } }
        .option-btn { background: white; border: 2px solid var(--brun-moyen); padding: 15px; font-size: 19px; cursor: pointer; border-radius: 6px; font-family: 'EB Garamond', serif; }
        .correct { background-color: #c8e6c9 !important; border-color: var(--reussite) !important; color: var(--reussite); }
        .incorrect { background-color: #ffcdd2 !important; border-color: var(--erreur) !important; color: var(--erreur); }

        /* TRI DE L'INTENDANT (NOUVEAU SYST√àME) */
        .zone-tri { display: flex; flex-direction: column; gap: 15px; margin-top: 15px; }
        @media (min-width: 600px) { .zone-tri { flex-direction: row; justify-content: space-around; } }
        .coffre { border: 3px dashed var(--brun-moyen); padding: 15px; min-height: 140px; background: rgba(255,255,255,0.5); border-radius: 10px; flex: 1; transition: 0.3s; }
        .item-tri { background: white; border: 2px solid var(--brun-moyen); padding: 10px 15px; margin: 6px; cursor: pointer; border-radius: 5px; font-weight: bold; display: inline-block; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        .item-tri.selected { border: 3px solid var(--or); background: var(--creme); }
        .items-deposes { display: flex; flex-wrap: wrap; justify-content: center; margin-top: 10px; }

        /* MATCHING GAME */
        .grille-matching { display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; max-width: 450px; margin: 0 auto; }
        .carte { aspect-ratio: 1; background: var(--brun-moyen); border: 2px solid var(--or); border-radius: 6px; position: relative; cursor: pointer; transform-style: preserve-3d; transition: transform 0.5s; }
        .carte.retournee { transform: rotateY(180deg); }
        .carte-face { position: absolute; width: 100%; height: 100%; backface-visibility: hidden; display: flex; align-items: center; justify-content: center; font-size: 28px; border-radius: 4px; }
        .carte-dos { background: var(--brun-moyen); color: var(--or); font-size: 20px; }
        .carte-devant { background: white; transform: rotateY(180deg); color: #000; }
        .carte.trouvee { visibility: hidden; pointer-events: none; }

        #feedback { margin-top: 20px; font-size: 22px; font-weight: bold; min-height: 30px; }

        footer { margin-top: 30px; color: var(--or); font-family: 'Cinzel', serif; text-align: center; font-size: 13px; line-height: 1.6; }
    </style>
</head>
<body>

    <div class="parchemin">
        <h1>La Vie Au Moyen √Çge</h1>
        <div class="equipe">Omar Chaar ‚Ä¢ Yasmine Chahaitly ‚Ä¢ Syma Demchkie ‚Ä¢ Hassan Rahal</div>

        <!-- MENU PRINCIPAL -->
        <div id="section-accueil" class="section-jeu" style="display: block;">
            <p style="font-size: 20px;">Choisissez votre √©preuve :</p>
            <button class="btn-medieval" onclick="ouvrirJeu('quiz')">üìú Le Quiz Royal</button><br>
            <button class="btn-medieval" onclick="ouvrirJeu('tri')">üì¶ Le Tri de l'Intendant</button><br>
            <button class="btn-medieval" onclick="ouvrirJeu('matching')">üÉè Le Jeu des Paires</button>
        </div>

        <!-- QUIZ -->
        <div id="section-quiz" class="section-jeu">
            <h2 style="font-family:'Cinzel';">Le Quiz Royal</h2>
            <div id="quiz-contenu">
                <div class="question-box" id="enonce-question"></div>
                <div class="options-grid" id="grille-options"></div>
            </div>
            <div id="resultat-quiz" style="display:none;">
                <h3 id="score-final" style="font-size: 26px;"></h3>
                <button class="btn-medieval" onclick="ouvrirJeu('quiz')">Recommencer</button>
            </div>
            <button class="btn-medieval" onclick="allerMenu()" style="margin-top:25px; opacity: 0.8;">Retour</button>
        </div>

        <!-- TRI DE L'INTENDANT (AVEC CORRECTION FINALE) -->
        <div id="section-tri" class="section-jeu">
            <h2 style="font-family:'Cinzel';">Le Tri de l'Intendant</h2>
            <p>Placez tous les objets dans les coffres, puis lancez la correction !</p>
            <div class="zone-tri">
                <div class="coffre" id="zone-paysan" onclick="tenterDepot('paysan')">
                    <h3>üåæ Paysans</h3>
                    <div class="items-deposes" id="depot-paysan"></div>
                </div>
                <div class="coffre" id="zone-seigneur" onclick="tenterDepot('seigneur')">
                    <h3>üè∞ Seigneurs</h3>
                    <div class="items-deposes" id="depot-seigneur"></div>
                </div>
            </div>
            <div id="liste-objets" style="margin-top:25px; min-height: 50px;"></div>
            <div id="controles-tri" style="margin-top:10px; display: none;">
                <button class="btn-medieval" onclick="verifierTri()">üîç V√©rifier le tri</button>
            </div>
            <button class="btn-medieval" onclick="allerMenu()" style="margin-top:25px; opacity: 0.8;">Retour</button>
        </div>

        <!-- MATCHING -->
        <div id="section-matching" class="section-jeu">
            <h2 style="font-family:'Cinzel';">Le Jeu des Paires</h2>
            <p>Retrouvez tous les symboles cach√©s !</p>
            <div class="grille-matching" id="grille-paires"></div>
            <button class="btn-medieval" onclick="allerMenu()" style="margin-top:20px; opacity: 0.8;">Retour</button>
        </div>

        <div id="feedback"></div>
    </div>

    <footer>
        PROJET : LA VIE AU MOYEN √ÇGE<br>
        R√©alis√© par : Omar Chaar, Yasmine Chahaitly, Syma Demchkie et Hassan Rahal
    </footer>

    <script>
        function ouvrirJeu(type) {
            document.querySelectorAll('.section-jeu').forEach(s => s.style.display = 'none');
            document.getElementById('feedback').innerText = '';
            const target = document.getElementById('section-' + type);
            if (target) target.style.display = 'block';
            
            if(type === 'quiz') lancerQuiz();
            if(type === 'tri') lancerTri();
            if(type === 'matching') lancerMatching();
        }

        function allerMenu() { ouvrirJeu('accueil'); }

        function showMsg(txt, col) {
            const f = document.getElementById('feedback');
            f.innerText = txt; f.style.color = col;
            if(txt !== "") setTimeout(() => { if(f.innerText === txt) f.innerText = ""; }, 3000);
        }

        // --- QUIZ ---
        const questions = [
            { q: "Quelle √©tait l'activit√© principale des paysans ?", r: ["L'agriculture", "La po√©sie", "La navigation", "La forge"], correct: 0 },
            { q: "O√π les moines recopiaient-ils les livres ?", r: ["Au ch√¢teau", "Au scriptorium", "Au march√©", "√Ä l'√©curie"], correct: 1 },
            { q: "Quel aliment √©tait la base de la nourriture ?", r: ["Les p√¢tes", "Le pain", "Les frites", "Le riz"], correct: 1 },
            { q: "Comment s'appelle l'anc√™tre du football ?", r: ["La p√©tanque", "Le tennis", "La soule", "Le cricket"], correct: 2 },
            { q: "En quel si√®cle se termine le Moyen √Çge ?", r: ["Xe si√®cle", "XIIe si√®cle", "XVe si√®cle", "XVIIIe si√®cle"], correct: 2 }
        ];
        let qIdx = 0, score = 0;
        function lancerQuiz() {
            qIdx = 0; score = 0;
            document.getElementById('quiz-contenu').style.display = 'block';
            document.getElementById('resultat-quiz').style.display = 'none';
            afficherQ();
        }
        function afficherQ() {
            const curr = questions[qIdx];
            document.getElementById('enonce-question').innerText = curr.q;
            const g = document.getElementById('grille-options');
            g.innerHTML = '';
            curr.r.forEach((rep, i) => {
                const b = document.createElement('button');
                b.className = 'option-btn'; b.innerText = rep;
                b.onclick = () => {
                    document.querySelectorAll('.option-btn').forEach(btn => btn.disabled = true);
                    if(i === curr.correct) { b.classList.add('correct'); score++; }
                    else { b.classList.add('incorrect'); document.querySelectorAll('.option-btn')[curr.correct].classList.add('correct'); }
                    setTimeout(() => {
                        qIdx++;
                        if(qIdx < questions.length) afficherQ();
                        else {
                            document.getElementById('quiz-contenu').style.display = 'none';
                            document.getElementById('resultat-quiz').style.display = 'block';
                            document.getElementById('score-final').innerText = `Score : ${score} / ${questions.length}`;
                        }
                    }, 1200);
                };
                g.appendChild(b);
            });
        }

        // --- TRI DE L'INTENDANT (CORRECTION FINALE) ---
        const elementsTri = [
            { nom: "Faux en fer", cat: "paysan" }, { nom: "√âp√©e grav√©e", cat: "seigneur" },
            { nom: "Sac de grain", cat: "paysan" }, { nom: "Couronne d'or", cat: "seigneur" },
            { nom: "Charrue", cat: "paysan" }, { nom: "Armure", cat: "seigneur" }
        ];
        let itemSel = null;

        function lancerTri() {
            const list = document.getElementById('liste-objets');
            list.innerHTML = '';
            document.getElementById('depot-paysan').innerHTML = '';
            document.getElementById('depot-seigneur').innerHTML = '';
            document.getElementById('controles-tri').style.display = 'none';
            itemSel = null;
            elementsTri.sort(() => Math.random() - 0.5).forEach((obj) => {
                creerBoutonTri(obj, list);
            });
        }

        function creerBoutonTri(obj, parent) {
            const d = document.createElement('div');
            d.className = 'item-tri';
            d.innerText = obj.nom;
            d.dataset.cat = obj.cat;
            d.onclick = (e) => {
                document.querySelectorAll('.item-tri').forEach(it => it.classList.remove('selected'));
                d.classList.add('selected');
                itemSel = { el: d, cat: obj.cat, nom: obj.nom };
                e.stopPropagation();
            };
            parent.appendChild(d);
        }

        function tenterDepot(coffreId) {
            if(!itemSel) { showMsg("S√©lectionnez un objet en bas !", "orange"); return; }
            
            const destination = document.getElementById('depot-' + coffreId);
            destination.appendChild(itemSel.el);
            itemSel.el.classList.remove('selected');
            itemSel.el.dataset.depot = coffreId; // On enregistre o√π il a √©t√© mis
            itemSel = null;

            // Si plus d'objets dans la liste, on montre le bouton de v√©rification
            if(document.getElementById('liste-objets').children.length === 0) {
                document.getElementById('controles-tri').style.display = 'block';
            }
        }

        function verifierTri() {
            const paysans = document.getElementById('depot-paysan').querySelectorAll('.item-tri');
            const seigneurs = document.getElementById('depot-seigneur').querySelectorAll('.item-tri');
            const liste = document.getElementById('liste-objets');
            let erreurs = 0;

            const verifier = (elements, coffreAttendu) => {
                elements.forEach(el => {
                    if(el.dataset.cat !== coffreAttendu) {
                        liste.appendChild(el); // Retour √† la liste
                        erreurs++;
                    } else {
                        el.style.backgroundColor = "#c8e6c9"; // Vert pour bon
                        el.onclick = null; // On ne peut plus le bouger
                    }
                });
            };

            verifier(paysans, "paysan");
            verifier(seigneurs, "seigneur");

            if(erreurs > 0) {
                showMsg(`Il y a ${erreurs} erreur(s). Les objets ont √©t√© renvoy√©s !`, "red");
                document.getElementById('controles-tri').style.display = 'none';
            } else {
                showMsg("F√©licitations ! L'intendant est ravi, tout est bien tri√©.", "green");
                document.getElementById('controles-tri').style.display = 'none';
            }
        }

        // --- MATCHING ---
        const symboles = ['üè∞', '‚öîÔ∏è', 'üëë', 'ü•ñ', 'üêé', 'üìú', '‚õ™', 'üõ°Ô∏è'];
        let cardsOpen = [], canFlip = true;
        function lancerMatching() {
            const g = document.getElementById('grille-paires');
            g.innerHTML = '';
            cardsOpen = []; canFlip = true;
            const deck = [...symboles, ...symboles].sort(() => Math.random() - 0.5);
            deck.forEach(s => {
                const c = document.createElement('div');
                c.className = 'carte';
                c.innerHTML = `<div class="carte-face carte-dos">‚öúÔ∏è</div><div class="carte-face carte-devant">${s}</div>`;
                c.onclick = () => {
                    if(!canFlip || c.classList.contains('retournee')) return;
                    c.classList.add('retournee');
                    cardsOpen.push({el: c, val: s});
                    if(cardsOpen.length === 2) {
                        canFlip = false;
                        if(cardsOpen[0].val === cardsOpen[1].val) {
                            setTimeout(() => {
                                cardsOpen.forEach(ca => ca.el.classList.add('trouvee'));
                                cardsOpen = []; canFlip = true;
                            }, 600);
                        } else {
                            setTimeout(() => {
                                cardsOpen.forEach(ca => ca.el.classList.remove('retournee'));
                                cardsOpen = []; canFlip = true;
                            }, 1000);
                        }
                    }
                };
                g.appendChild(c);
            });
        }
    </script>
</body>
</html>
